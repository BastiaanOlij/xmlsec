<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>Klasses and objects.</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REL="HOME"
TITLE="XML Security Library Reference Manual"
HREF="index.html"><LINK
REL="UP"
TITLE="Adding support for new cryptographic library."
HREF="xmlsec-notes-new-crypto.html"><LINK
REL="PREVIOUS"
TITLE="xmlSecCryptoApp* functions."
HREF="xmlsec-notes-new-crypto-functions.html"><LINK
REL="NEXT"
TITLE="Cryptographic transforms."
HREF="xmlsec-notes-new-crypto-transforms.html"><STYLE
TYPE="text/css"
>.synopsis, .classsynopsis {
    background: #eeeeee;
    border: solid 1px #aaaaaa;
    padding: 0.5em;
}
.programlisting {
    background: #eeeeff;
    border: solid 1px #aaaaff;
    padding: 0.5em;
}
.variablelist {
    padding: 4px;
    margin-left: 3em;
}
.navigation {
    background: #ffeeee;
    border: solid 1px #ffaaaa;
    margin-top: 0.5em;
    margin-bottom: 0.5em;
}
.navigation a {
    color: #770000;
}
.navigation a:visited {
    color: #550000;
}
.navigation .title {
    font-size: 200%;
}</STYLE
></HEAD
><BODY
CLASS="SECT1"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><TABLE
WIDTH="100%"
CLASS="navigation"
SUMMARY="Navigation header"
CELLPADDING="2"
CELLSPACING="2"
><TR
VALIGN="middle"
><TD
><A
ACCESSKEY="p"
HREF="xmlsec-notes-new-crypto-functions.html"
><IMG
SRC="left.png"
WIDTH="16"
HEIGHT="16"
BORDER="0"
ALT="Prev"></A
></TD
><TD
><A
ACCESSKEY="u"
HREF="xmlsec-notes-new-crypto.html"
><IMG
SRC="up.png"
WIDTH="16"
HEIGHT="16"
BORDER="0"
ALT="Up"></A
></TD
><TD
><A
ACCESSKEY="h"
HREF="index.html"
><IMG
SRC="home.png"
WIDTH="16"
HEIGHT="16"
BORDER="0"
ALT="Home"></A
></TD
><TH
WIDTH="100%"
align="center"
>XML Security Library Reference Manual</TH
><TD
><A
ACCESSKEY="n"
HREF="xmlsec-notes-new-crypto-transforms.html"
><IMG
SRC="right.png"
WIDTH="16"
HEIGHT="16"
BORDER="0"
ALT="Next"></A
></TD
></TR
></TABLE
><BR
CLEAR="all"><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="XMLSEC-NOTES-NEW-CRYPTO-KLASSES"
>Klasses and objects.</A
></H1
><P
>The XML Security Library is written in C but it uses some OOP techniques:
	the objects in the library have "klasses" and there is "klasses" inheritance.
	(see <A
HREF="xmlsec-signature-klasses.html"
>signature</A
> and
	<A
HREF="xmlsec-encryption-klasses.html"
>encryption</A
> klasses 
	diagrams). The "klass" is different from C++ "class" (btw, this is 
	one of the reasons why it is spelled differently). The idea of "klasses" 
	used in XML Security Library are close to one in the GLIB/GTK/GNOME
	and many other C projects. If you ever seen an OOP code written in C
	you should find everything familiar.
	</P
><P
>XML Security Library "klass" includes three main parts:
	<P
></P
><UL
><LI
><P
>"Klass" declaration structure that defines "klass" interfaces
	and global constant data (for example, the human-readable name of 
	the "klass").
	<DIV
CLASS="EXAMPLE"
><A
NAME="AEN562"
></A
><P
><B
>Example 6. Base transform "klass" and its child XPath transform "klass" structure.</B
></P
><PRE
CLASS="PROGRAMLISTING"
>struct _xmlSecTransformKlass {
    /* data */
    size_t				klassSize;
    size_t				objSize;
    const xmlChar*			name;
    const xmlChar*			href;
    xmlSecTransformUsage		usage;

    /* methods */
    xmlSecTransformInitializeMethod	initialize;
    xmlSecTransformFinalizeMethod	finalize;

    xmlSecTransformNodeReadMethod	readNode;
    xmlSecTransformNodeWriteMethod	writeNode;

    ...
};

...

static xmlSecTransformKlass xmlSecTransformXPathKlass = {
    /* klass/object sizes */
    sizeof(xmlSecTransformKlass),	/* size_t klassSize */
    xmlSecXPathTransformSize,		/* size_t objSize */

    xmlSecNameXPath,			/* const xmlChar* name; */
    xmlSecXPathNs, 			/* const xmlChar* href; */
    xmlSecTransformUsageDSigTransform,	/* xmlSecTransformUsage	usage; */

    xmlSecTransformXPathInitialize,	/* xmlSecTransformInitializeMethod initialize; */
    xmlSecTransformXPathFinalize,	/* xmlSecTransformFinalizeMethod finalize; */
    xmlSecTransformXPathNodeRead,	/* xmlSecTransformNodeReadMethod readNode; */
    NULL,				/* xmlSecTransformNodeWriteMethod writeNode; */
    
    ...
};
	    </PRE
></DIV
>
	</P
></LI
><LI
><P
>"Klass" id which is simply a pointer to the "klass"
	declaration strucutre. "Klass" id is used to bind "klass" objects 
	to the "klass" declaration and to pass "klass" strucutre to functions.
	<DIV
CLASS="EXAMPLE"
><A
NAME="AEN567"
></A
><P
><B
>Example 7. Base transform "klass" id declaration and its child XPath transform "klass" id implementation.</B
></P
><PRE
CLASS="PROGRAMLISTING"
>typedef const struct _xmlSecTransformKlass		xmlSecTransformKlass, *xmlSecTransformId;

...

#define xmlSecTransformXPathId 		xmlSecTransformXPathGetKlass()

...

xmlSecTransformId 
xmlSecTransformXPathGetKlass(void) {
    return(&#38;xmlSecTransformXPathKlass);
}
	    </PRE
></DIV
>
	</P
></LI
><LI
><P
>"Klass" object structure that contains object specific
	data. The child object specific data are placed after the parent "klass"
	object data.
	<DIV
CLASS="EXAMPLE"
><A
NAME="AEN572"
></A
><P
><B
>Example 8. Base transform object strucutre and its child XPath transform object.</B
></P
><PRE
CLASS="PROGRAMLISTING"
>struct _xmlSecTransform {
    xmlSecTransformId 			id; 
    xmlSecTransformOperation		operation;
    xmlSecTransformStatus		status;
    xmlNodePtr				hereNode;

    /* transforms chain */
    xmlSecTransformPtr			next;
    xmlSecTransformPtr			prev;
    
    ...
};

...

/******************************************************************************
 *
 * XPath/XPointer transforms
 *
 * xmlSecPtrList with XPath expressions is located after xmlSecTransform structure
 * 
 *****************************************************************************/
#define xmlSecXPathTransformSize	\
    (sizeof(xmlSecTransform) + sizeof(xmlSecPtrList))
#define xmlSecXPathTransformGetDataList(transform) \
    ((xmlSecTransformCheckSize((transform), xmlSecXPathTransformSize)) ? \
	(xmlSecPtrListPtr)(((unsigned char*)(transform)) + sizeof(xmlSecTransform)) : \
	(xmlSecPtrListPtr)NULL)
	    </PRE
></DIV
>
	</P
></LI
></UL
>
	</P
></DIV
><TABLE
CLASS="navigation"
WIDTH="100%"
SUMMARY="Navigation footer"
CELLPADDING="2"
CELLSPACING="2"
><TR
VALIGN="middle"
><TD
ALIGN="left"
><A
ACCESSKEY="p"
HREF="xmlsec-notes-new-crypto-functions.html"
><B
>&lt;&lt;&lt;&nbsp;xmlSecCryptoApp* functions.</B
></A
></TD
><TD
ALIGN="right"
><A
ACCESSKEY="n"
HREF="xmlsec-notes-new-crypto-transforms.html"
><B
>Cryptographic transforms.&nbsp;&gt;&gt;&gt;</B
></A
></TD
></TR
></TABLE
></BODY
></HTML
>