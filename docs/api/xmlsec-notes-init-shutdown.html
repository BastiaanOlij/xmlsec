<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>Initialization and shutdown.</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REL="HOME"
TITLE="XML Security Library Reference Manual"
HREF="index.html"><LINK
REL="UP"
TITLE="XML Security Library Tutorial"
HREF="xmlsec-notes.html"><LINK
REL="PREVIOUS"
TITLE="Compiling and linking on other systems."
HREF="xmlsec-notes-compiling-others.html"><LINK
REL="NEXT"
TITLE="Signing and encrypting documents."
HREF="xmlsec-notes-sign-encrypt.html"><STYLE
TYPE="text/css"
>.synopsis, .classsynopsis {
    background: #eeeeee;
    border: solid 1px #aaaaaa;
    padding: 0.5em;
}
.programlisting {
    background: #eeeeff;
    border: solid 1px #aaaaff;
    padding: 0.5em;
}
.variablelist {
    padding: 4px;
    margin-left: 3em;
}
.navigation {
    background: #ffeeee;
    border: solid 1px #ffaaaa;
    margin-top: 0.5em;
    margin-bottom: 0.5em;
}
.navigation a {
    color: #770000;
}
.navigation a:visited {
    color: #550000;
}
.navigation .title {
    font-size: 200%;
}</STYLE
></HEAD
><BODY
CLASS="CHAPTER"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><TABLE
WIDTH="100%"
CLASS="navigation"
SUMMARY="Navigation header"
CELLPADDING="2"
CELLSPACING="2"
><TR
VALIGN="middle"
><TD
><A
ACCESSKEY="p"
HREF="xmlsec-notes-compiling-others.html"
><IMG
SRC="left.png"
WIDTH="16"
HEIGHT="16"
BORDER="0"
ALT="Prev"></A
></TD
><TD
><A
ACCESSKEY="u"
HREF="xmlsec-notes.html"
><IMG
SRC="up.png"
WIDTH="16"
HEIGHT="16"
BORDER="0"
ALT="Up"></A
></TD
><TD
><A
ACCESSKEY="h"
HREF="index.html"
><IMG
SRC="home.png"
WIDTH="16"
HEIGHT="16"
BORDER="0"
ALT="Home"></A
></TD
><TH
WIDTH="100%"
align="center"
>XML Security Library Reference Manual</TH
><TD
><A
ACCESSKEY="n"
HREF="xmlsec-notes-sign-encrypt.html"
><IMG
SRC="right.png"
WIDTH="16"
HEIGHT="16"
BORDER="0"
ALT="Next"></A
></TD
></TR
></TABLE
><DIV
CLASS="CHAPTER"
><H1
><A
NAME="XMLSEC-NOTES-INIT-SHUTDOWN"
></A
>Initialization and shutdown.</H1
><P
>XML Security Library initialization/shutdown 
	process includes initialization and shutdown of the
	dependent libraries:
	<P
></P
><UL
><LI
><P
>libxml library;</P
></LI
><LI
><P
>libxslt library;</P
></LI
><LI
><P
>crypto library (OpenSSL, GnuTLS, GCrypt, NSS, ...);</P
></LI
><LI
><P
>xmlsec library 
		(<A
HREF="xmlsec-xmlsec.html#XMLSECINIT"
>xmlSecInit</A
> 
		and <A
HREF="xmlsec-xmlsec.html#XMLSECSHUTDOWN"
>xmlSecShutdown</A
> 
		functions);
	    </P
></LI
><LI
><P
>xmlsec-crypto library
		(<A
HREF="xmlsec-dl.html#XMLSECCRYPTODLLOADLIBRARY"
>xmlSecCryptoDLLoadLibrary</A
> 
		to load xmlsec-crypto library dynamicaly if needed, 
		<A
HREF="xmlsec-app.html#XMLSECCRYPTOINIT"
>xmlSecCryptoInit</A
> 
		and <A
HREF="xmlsec-app.html#XMLSECCRYPTOSHUTDOWN"
>xmlSecCryptoShutdown</A
> 
		functions);
	    </P
></LI
></UL
>
	xmlsec-crypto library also provides a convinient functions 
	<GTKDOCLINK
HREF="XMLSECAPPCRYPTOINIT"
>xmlSecAppCryptoInit</GTKDOCLINK
> 
	and <GTKDOCLINK
HREF="XMLSECAPPCRYPTOSHUTDOWN"
>xmlSecAppCryptoShutdown</GTKDOCLINK
> 
	to initialize the crypto library itself but application can do it 
	by itself.
	</P
><P
>	     <DIV
CLASS="EXAMPLE"
><A
NAME="AEN137"
></A
><P
><B
>Example 1. Initializing application.</B
></P
><PRE
CLASS="PROGRAMLISTING"
>    /* Init libxml and libxslt libraries */
    xmlInitParser();
    LIBXML_TEST_VERSION
    xmlLoadExtDtdDefaultValue = XML_DETECT_IDS | XML_COMPLETE_ATTRS;
    xmlSubstituteEntitiesDefault(1);
#ifndef XMLSEC_NO_XSLT
    xmlIndentTreeOutput = 1; 
#endif /* XMLSEC_NO_XSLT */
        	
    /* Init xmlsec library */
    if(xmlSecInit() &#60; 0) {
	fprintf(stderr, "Error: xmlsec initialization failed.\n");
	return(-1);
    }

    /* Check loaded library version */
    if(xmlSecCheckVersion() != 1) {
	fprintf(stderr, "Error: loaded xmlsec library version is not compatible.\n");
	return(-1);
    }    

    /* Load default crypto engine if we are supporting dynamic
     * loading for xmlsec-crypto libraries. Use the crypto library
     * name ("openssl", "nss", etc.) to load corresponding 
     * xmlsec-crypto library.
     */
#ifdef XMLSEC_CRYPTO_DYNAMIC_LOADING
    if(xmlSecCryptoDLLoadLibrary(NULL) &#60; 0) {
	fprintf(stderr, "Error: unable to load default xmlsec-crypto library. Make sure\n"
			"that you have it installed and check shared libraries path\n"
			"(LD_LIBRARY_PATH) envornment variable.\n");
	return(-1);	
    }
#endif /* XMLSEC_CRYPTO_DYNAMIC_LOADING */

    /* Init crypto library */
    if(xmlSecCryptoAppInit(NULL) &#60; 0) {
	fprintf(stderr, "Error: crypto initialization failed.\n");
	return(-1);
    }

    /* Init xmlsec-crypto library */
    if(xmlSecCryptoInit() &#60; 0) {
	fprintf(stderr, "Error: xmlsec-crypto initialization failed.\n");
	return(-1);
    }
		</PRE
></DIV
>
	</P
><P
>	     <DIV
CLASS="EXAMPLE"
><A
NAME="AEN141"
></A
><P
><B
>Example 2. Shutting down application.</B
></P
><PRE
CLASS="PROGRAMLISTING"
>    /* Shutdown xmlsec-crypto library */
    xmlSecCryptoShutdown();
    
    /* Shutdown crypto library */
    xmlSecCryptoAppShutdown();
    
    /* Shutdown xmlsec library */
    xmlSecShutdown();

    /* Shutdown libxslt/libxml */
#ifndef XMLSEC_NO_XSLT
    xsltCleanupGlobals();            
#endif /* XMLSEC_NO_XSLT */
    xmlCleanupParser();		
		</PRE
></DIV
>
    </P
></DIV
><TABLE
CLASS="navigation"
WIDTH="100%"
SUMMARY="Navigation footer"
CELLPADDING="2"
CELLSPACING="2"
><TR
VALIGN="middle"
><TD
ALIGN="left"
><A
ACCESSKEY="p"
HREF="xmlsec-notes-compiling-others.html"
><B
>&lt;&lt;&lt;&nbsp;Compiling and linking on other systems.</B
></A
></TD
><TD
ALIGN="right"
><A
ACCESSKEY="n"
HREF="xmlsec-notes-sign-encrypt.html"
><B
>Signing and encrypting documents.&nbsp;&gt;&gt;&gt;</B
></A
></TD
></TR
></TABLE
></BODY
></HTML
>